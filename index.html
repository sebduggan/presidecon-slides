<!DOCTYPE html>
<html lang="en">
<head>
	<title>PresideCon 2017: Images</title>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="shower/themes/ribbon-mod/styles/screen-16x10.css">
</head>
<body class="shower list">

	<header class="caption">
		<h1>Woprking with images in Preside</h1>
		<p>Seb Duggan</p>
	</header>

	<section class="slide">
		<h2>Working with images in Preside</h2>

		<ul>
			<li>Derivatives and transformations</li>
			<li>Rendering images in Preside</li>
			<li>Current limitations of derivatives</li>
			<li>New features in Preside 10.9</li>
			<li>Responsive images</li>
			<li>Demonstration in Preside</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Derivatives</h2>

		<ul>
			<li>Programmatically defined rules to transform assets</li>
			<li>Preside has a number of built-in derivatives
				<ul>
					<li><code>adminThumbnail</code></li>
					<li><code>pickerIcon</code></li>
				</ul>
			</li>
			<li>Can be chained, for example to create a PDF page image before resizing</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Transformation: shrinkToFit</h2>

		<ul>
			<li>Requires <code>width</code> and <code>height</code> arguments</li>
			<li>Optionally specify <code>quality</code> (defaults to "highPerformance")</li>
			<li>Will resize the image to be contained within the dimensions</li>
			<li>Maintains the image’s aspect ratio</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Transformation: shrinkToFit</h2>

		<div>
			<p><code>pageThumbnail</code> is one of Preside’s built-in derivatives:</p>

			<pre>
				<code>settings.assetManager.derivatives.pageThumbnail = {</code>
				<code>	  permissions     = "inherit"</code>
				<code>	, transformations = [ {</code>
				<code>		  method = "shrinkToFit"</code>
				<code>		, args   = { width=100, height=100 }</code>
				<code>	  } ]</code>
				<code>};</code>
			</pre>
		</div>
	</section>

	<section class="slide">
		<h2>Transformation: shrinkToFit</h2>

		<img src="img/country-lane.jpg" height="400">
	</section>

	<section class="slide">
		<h2>Transformation: shrinkToFit</h2>

		<img src="img/country-lane.jpg" width="100" style="padding:20px 0;background: none;">
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<ul>
			<li>Takes <code>width</code> and/or <code>height</code> arguments</li>
			<li>Optionally specify <code>quality</code> (defaults to "highPerformance")</li>
			<li>Optionally specify <code>maintainAspectRatio</code> (defaults to false)</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<pre>
			<code>settings.assetManager.derivatives.width300 = {</code>
			<code>	  permissions     = "inherit"</code>
			<code>	, transformations = [ {</code>
			<code>		  method = "resize"</code>
			<code>		, args   = { width=300 }</code>
			<code>	  } ]</code>
			<code>};</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<img src="img/dragonfly.jpg">
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<img src="img/dragonfly.jpg" width="300">
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<pre>
			<code>settings.assetManager.derivatives.square300 = {</code>
			<code>	  permissions     = "inherit"</code>
			<code>	, transformations = [ {</code>
			<code>		  method = "resize"</code>
			<code>		, args   = { width=300, height=300 }</code>
			<code>	  } ]</code>
			<code>};</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<img src="img/dragonfly.jpg">
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<img src="img/dragonfly.jpg" width="300" height="300">
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<pre>
			<code>settings.assetManager.derivatives.square300 = {</code>
			<code>	  permissions     = "inherit"</code>
			<code>	, transformations = [ {</code>
			<code>		  method = "resize"</code>
			<code>		, args   = {</code>
			<code>			  width               = 300</code>
			<code>			, height              = 300</code>
			<code>			, maintainAspectRatio = true</code>
			<code>		  }</code>
			<code>	  } ]</code>
			<code>};</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<img src="img/dragonfly.jpg">
	</section>

	<section class="slide">
		<h2>Transformation: resize</h2>

		<img src="img/dragonfly-square.jpg">
	</section>

	<section class="slide">
		<h2>Rendering images</h2>

		<p>Method 1: use <code>event.buildLink()</code></p>

		<pre>
			<code>imageUrl = event.buildLink(</code>
			<code>	  assetId    = "..."</code>
			<code>	, derivative = "bannerImage"</code>
			<code>);</code>
		</pre>

		<ul>
			<li>returns the URL of the image</li>
			<li>omitting <code>derivative</code> will return the original image</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Rendering images</h2>

		<p>Method 2: use <code>renderAsset()</code></p>

		<pre>
			<code>renderedImage = renderAsset(</code>
			<code>	  assetId = "..."</code>
			<code>	, args    = { derivative="bannerImage" }</code>
			<code>);</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Rendering images</h2>

		<p>Method 2: use <code>renderAsset()</code></p>

		<pre>
			<code>renderedImage = renderAsset(</code>
			<code>	  assetId = "..."</code>
			<code>	, args    = {</code>
			<code>		  derivative = "bannerImage"</code>
			<code>		, class      = "customClass"</code>
			<code>		, label      = "Image description"</code>
			<code>	  }</code>
			<code>);</code>
		</pre>

		<ul>
			<li>default renderer returns the complete <code>&lt;img&gt;</code> tag</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Custom image renderer</h2>

		<ul>
			<li>By default, <code>renderAsset()</code> uses the default renderer for the file type, e.g. <code>renderers.asset.image.default</code></li>
			<li>Renderer can be just a view, or can have a handler</li>
			<li>Renderer can be targeted at specific filetypes, e.g. <code>renderers.asset.jpg.default</code></li>
			<li>Specify a context to use a custom renderer</li>
		</ul>

		<pre>
			<code>renderedImage = renderAsset(</code>
			<code>	  assetId = "..."</code>
			<code>	, context = "banner"</code>
			<code>);</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Custom image renderer</h2>

		<p>If context is "banner", a JPEG image asset would be rendered using the first of these that is available:</p>

		<ul>
			<li>renderers.asset.jpg.banner</li>
			<li>renderers.asset.image.banner</li>
			<li>renderers.asset.jpg.default</li>
			<li>renderers.asset.image.default</li>
			<li>renderers.asset.default</li>
		</ul>
	</section>

	<section class="slide">
		<h2>Custom image renderer</h2>

		<p><code>/application/views/renderers/asset/image/banner.cfm</code></p>

		<pre>
			<code>&lt;cfscript&gt;</code>
			<code>    id       = args.id    ?: "";</code>
			<code>    label    = args.label ?: "";</code>
			<code>    imageUrl = event.buildLink(</code>
			<code>    	  assetId    = id</code>
			<code>    	, derivative = "bannerImage"</code>
			<code>    );</code>
			<code>&lt;/cfscript&gt;</code>
			<code>&lt;cfoutput&gt;</code>
			<code>    &lt;div class="banner-image"&gt;</code>
			<code>        &lt;img src="#imageUrl#" alt="#label#" title="#label#" /&gt;</code>
			<code>    &lt;/div&gt;</code>
			<code>&lt;/cfoutput&gt;</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Resize limitations (1)</h2>

		<p>Take this image as an example:</p>

		<img src="img/puffin-1.jpg">
	</section>

	<section class="slide">
		<h2>Resize limitations (1)</h2>

		<p>Resized using our 300x300 derivative:</p>

		<img src="img/puffin-1-crop.jpg">
	</section>

	<section class="slide">
		<h2>Resize limitations (1)</h2>

		<p>How about a 650x200 banner derivative?</p>

		<img src="img/puffin-1-banner-crop.jpg">
	</section>

	<section class="slide">
		<h2>Resize limitations (1)</h2>

		<p>Previous options for dealing with this:</p>

		<ol>
			<li>Live with the bad cropping</li>
			<li>Upload an extra asset to the page — the same source image, but pre-cropped externally
				<ul>
					<li>Places extra burden on the user</li>
					<li>Makes our page object untidy</li>
				</ul>
			</li>
		</ol>
	</section>

	<section class="slide">
		<h2>Focal Points</h2>

		<p>Introduced in Preside 10.9</p>

		<img src="img/focal-point.png" height="350">
	</section>

	<section class="slide">
		<h2>Focal Points</h2>

		<p>Introduced in Preside 10.9</p>

		<img src="img/focal-point-selected.png" height="350">
	</section>

	<section class="slide">
		<h2>Focal Points</h2>

		<p>Now our square crop will produce this:</p>

		<img src="img/puffin-1-focal-point-crop.jpg">
	</section>

	<section class="slide">
		<h2>Focal Points</h2>

		<p>...and our banner derivative:</p>

		<img src="img/puffin-1-banner-focal-point-crop.jpg">
	</section>

	<section class="slide">
		<h2>Resize limitations (2)</h2>

		<div>
			<p>Here is another sample image:</p>

			<img src="img/puffin-2.jpg" height="400">
		</div>
	</section>

	<section class="slide">
		<h2>Resize limitations (2)</h2>

		<p>Resized as a 100x100 thumbnail:</p>

		<img src="img/puffin-2-crop.jpg" height="100">
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Introduced in Preside 10.9</p>

		<img src="img/crop-hint.png" height="350">
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Introduced in Preside 10.9</p>

		<img src="img/crop-hint-selected.png" height="350">
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Simply tell your derivative to use crop hints:</p>

		<pre>
			<code>settings.assetManager.derivatives.croppedThumbnail = {</code>
			<code>	  permissions = "inherit"</code>
			<code>	, transformations = [ {</code>
			<code>			  method = "resize"</code>
			<code>			, args   = {</code>
			<code>				  width       = 100</code>
			<code>				, height      = 100</code>
			<code>				, useCropHint = true</code>
			<code>			  }</code>
			<code>	  }	]</code>
			<code>};</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Now our thumbnail will look like this:</p>

		<img src="img/puffin-2-crop-hint-crop.jpg" height="100">
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Crop hints are also useful for cropping portraits:</p>

		<img src="img/businessman.jpg" height="350">
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Crop hints are also useful for cropping portraits:</p>

		<img src="img/businessman-crop.jpg" height="200">
	</section>

	<section class="slide">
		<h2>Crop Hints</h2>

		<p>Crop hints are also useful for cropping portraits:</p>

		<img src="img/businessman-crop.jpg" height="200" style="border-radius:50%;">

		<pre>
			<code>img.avatar {</code>
			<code>	border-radius : 50%;</code>
			<code>}</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Responsive Images</h2>

		<ul>
			<li>Two different use cases
				<ul>
					<li>Different resolutions of the same image</li>
					<li>Art direction: variations on an image</li>
				</ul>
			</li>
			<li>Two methods of implementation
				<ul>
					<li><code>&lt;img srcset="..."&gt;</code></li>
					<li><code>&lt;picture/&gt;</code></li>
				</ul>
			</li>
			<li>Only load the preferred image version</li>
			<li>Excellent support by modern browsers</li>
			<li>Degrades gracefully</li>
		</li>
	</section>

	<section data-markdown="slides/srcset.md"></section>

	<section class="slide">
		<h2>srcset</h2>

		<img src="img/caniuse-srcset.png" width="750">
	</section>

	<section class="slide">
		<h2>picture</h2>

		<pre>
			<code>&lt;picture&gt;</code>
			<code>	&lt;source srcset="large.jpg"  media="(min-width: 901px)"&gt;</code>
			<code>	&lt;source srcset="medium.jpg" media="(min-width: 600px)"&gt;</code>
			<code>	&lt;source srcset="small.jpg"&gt;</code>
			<code>	&lt;img src="medium.jpg" alt="..."&gt;</code>
			<code>&lt;/picture&gt;</code>
		</pre>

		<ul>
			<li>More complex, but more controllable</li>
			<li>Best for art direction</li>
			<li><code>srcset</code> can include multiple resolutions</li>
			<li>Falls back to <code>&lt;img&gt;</code> content if not supported</li>
		</ul>
	</section>

	<section class="slide">
		<h2>picture</h2>

		<img src="img/caniuse-picture.png" width="750">
	</section>

	<section class="slide">
		<h2>Some examples in Preside</h2>
	</section>

	<footer class="badge">
		<a href="https://github.com/shower/shower">Fork me on GitHub</a>
	</footer>

	<script src="shower/shower.min.js"></script>

</body>
</html>
