<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>PresideCon 2017: Images</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/moon-preside.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h2>Working with images in Preside</h2>

					<ul>
						<li class="fragment">Derivatives and transformations</li>
						<li class="fragment">Rendering images in Preside</li>
						<li class="fragment">Current limitations of derivatives</li>
						<li class="fragment">New features in Preside 10.9</li>
						<li class="fragment">Responsive images</li>
						<li class="fragment">Demonstration in Preside</li>
					</ul>
				</section>

				<section>
					<h2>Derivatives</h2>

					<ul>
						<li class="fragment">Programmatically defined rules to transform assets</li>
						<li class="fragment">Preside has a number of built-in derivatives
							<ul>
								<li class="fragment"><code>adminThumbnail</code></li>
								<li class="fragment"><code>pickerIcon</code></li>
							</ul>
						</li>
						<li class="fragment">Can be chained, for example to create a PDF page image before resizing</li>
					</ul>
				</section>

				<section>
					<h2>Transformation: shrinkToFit</h2>

					<ul>
						<li class="fragment">Requires <code>width</code> and <code>height</code> arguments</li>
						<li class="fragment">Optionally specify <code>quality</code> (defaults to "highPerformance")</li>
						<li class="fragment">Will resize the image to be contained within the dimensions</li>
						<li class="fragment">Maintains the image’s aspect ratio</li>
					</ul>
				</section>

				<section>
					<h2>Transformation: shrinkToFit</h2>

					<div class="fragment">
						<p><code>pageThumbnail</code> is one of Preside’s built-in derivatives, and shrinks the image to fit within a 100x100 box:</p>

						<pre><code data-trim class="typescript">
						settings.assetManager.derivatives.pageThumbnail = {
							  permissions     = "inherit"
							, transformations = [
								{
									  method = "shrinkToFit"
									, args   = { width=100, height=100 }
								}
							  ]
						};
						</code></pre>
					</div>
				</section>

				<section>
					<h2>Transformation: shrinkToFit</h2>

					<img src="img/country-lane.jpg" height="400">
				</section>

				<section>
					<h2>Transformation: shrinkToFit</h2>

					<img src="img/country-lane.jpg" width="100" style="padding:20px 0;background: none;">
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<ul>
						<li class="fragment">Takes <code>width</code> and/or <code>height</code> arguments</li>
						<li class="fragment">Optionally specify <code>quality</code> (defaults to "highPerformance")</li>
						<li class="fragment">Optionally specify <code>maintainAspectRatio</code> (defaults to false)</li>
					</ul>
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<pre><code data-trim class="typescript">
					settings.assetManager.derivatives.width300 = {
						  permissions     = "inherit"
						, transformations = [
							{
								  method = "resize"
								, args   = { width=300 }
							}
						  ]
					};
					</code></pre>
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<img src="img/dragonfly.jpg">
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<img src="img/dragonfly.jpg" width="300">
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<pre><code data-trim class="typescript">
					settings.assetManager.derivatives.square300 = {
						  permissions     = "inherit"
						, transformations = [
							{
								  method = "resize"
								, args   = { width=300, height=300 }
							}
						  ]
					};
					</code></pre>
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<img src="img/dragonfly.jpg">
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<img src="img/dragonfly.jpg" width="300" height="300">
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<pre><code data-trim class="typescript">
					settings.assetManager.derivatives.square300 = {
						  permissions     = "inherit"
						, transformations = [
							{
								  method = "resize"
								, args   = {
									  width               = 300
									, height              = 300
									, maintainAspectRatio = true
								  }
							}
						  ]
					};
					</code></pre>
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<img src="img/dragonfly.jpg">
				</section>

				<section>
					<h2>Transformation: resize</h2>

					<img src="img/dragonfly-square.jpg">
				</section>

				<section>
					<h2>Rendering images</h2>

					<p class="fragment">Method 1: use <code>event.buildLink()</code></p>

					<pre class="fragment"><code data-trim class="typescript">
					imageUrl = event.buildLink(
						  assetId    = "..."
						, derivative = "bannerImage"
					);
					</code></pre>

					<ul>
						<li class="fragment">returns the URL of the image</li>
						<li class="fragment">omitting <code>derivative</code> will return the original image</li>
					</ul>
				</section>

				<section>
					<h2>Rendering images</h2>

					<p class="fragment">Method 2: use <code>renderAsset()</code></p>

					<pre class="fragment"><code data-trim class="typescript">
					renderedImage = renderAsset(
						  assetId = "..."
						, args    = { derivative="bannerImage" }
					);
					</code></pre>
				</section>

				<section>
					<h2>Rendering images</h2>

					<p>Method 2: use <code>renderAsset()</code></p>

					<pre><code data-trim class="typescript">
					renderedImage = renderAsset(
						  assetId = "..."
						, args    = {
							  derivative = "bannerImage"
							, class      = "customClass"
							, label      = "Image description"
						  }
					);
					</code></pre>

					<ul>
						<li class="fragment">default renderer returns the complete <code>&lt;img&gt;</code> tag</li>
					</ul>
				</section>

				<section>
					<h2>Custom image renderer</h2>

					<ul>
						<li class="fragment">By default, <code>renderAsset()</code> uses the default renderer for the file type, e.g. <code>renderers.asset.image.default</code></li>
						<li class="fragment">Renderer can be just a view, or can have a handler</li>
						<li class="fragment">Renderer can be targeted at specific filetypes, e.g. <code>renderers.asset.jpg.default</code></li>
						<li class="fragment">Specify a context to use a custom renderer</li>
					</ul>

					<pre class="fragment"><code data-trim class="typescript">
					renderedImage = renderAsset(
						  assetId = "..."
						, context = "banner"
					);
					</code></pre>
				</section>

				<section>
					<h2>Custom image renderer</h2>

					<p class="fragment">If context is "banner", a JPEG image asset would be rendered using the first of these that is available:</p>

					<ul>
						<li class="fragment">renderers.asset.jpg.banner</li>
						<li class="fragment">renderers.asset.image.banner</li>
						<li class="fragment">renderers.asset.jpg.default</li>
						<li class="fragment">renderers.asset.image.default</li>
						<li class="fragment">renderers.asset.default</li>
					</ul>
				</section>

				<section>
					<h2>Custom image renderer</h2>

					<code>/application/views/renderers/
					asset/image/banner.cfm</code>

					<pre><code data-trim class="html">
						<cfscript>
						    id       = args.id    ?: "";
						    label    = args.label ?: "";
						    imageUrl = event.buildLink(
						    	  assetId    = id
						    	, derivative = "bannerImage"
						    );
						</cfscript>
						<cfoutput>
						    <div class="banner-image">
						        <img src="#imageUrl#" alt="#label#" title="#label#" />
						    </div>
						</cfoutput>
					</code></pre>
				</section>

				<section>
					<h2>Resize limitations (1)</h2>

					<p>Take this image as an example:</p>

					<img src="img/puffin-1.jpg">
				</section>

				<section>
					<h2>Resize limitations (1)</h2>

					<p>Resized using our 300x300 derivative:</p>

					<img src="img/puffin-1-crop.jpg">
				</section>

				<section>
					<h2>Resize limitations (1)</h2>

					<p>How about a 650x200 banner derivative?</p>

					<img src="img/puffin-1-banner-crop.jpg">
				</section>

				<section>
					<h2>Resize limitations (1)</h2>

					<p>Previous options for dealing with this:</p>

					<ol>
						<li class="fragment">Live with the bad cropping</li>
						<li class="fragment">Upload an extra asset to the page — the same source image, but pre-cropped externally
							<ul>
								<li class="fragment">Places extra burden on the user</li>
								<li class="fragment">Makes our page object untidy</li>
							</ul>
						</li>
					</ol>
				</section>

				<section>
					<h2>Focal Points</h2>

					<p class="fragment">Introduced in Preside 10.9</p>

					<img src="img/focal-point.png" height="350" class="fragment">
				</section>

				<section>
					<h2>Focal Points</h2>

					<p>Introduced in Preside 10.9</p>

					<img src="img/focal-point-selected.png" height="350">
				</section>

				<section>
					<h2>Focal Points</h2>

					<p>Now our square crop will produce this:</p>

					<img src="img/puffin-1-focal-point-crop.jpg" class="fragment">
				</section>

				<section>
					<h2>Focal Points</h2>

					<p>...and our banner derivative:</p>

					<img src="img/puffin-1-banner-focal-point-crop.jpg" class="fragment">
				</section>

				<section>
					<h2>Resize limitations (2)</h2>

					<div class="fragment">
						<p>Here is another sample image:</p>

						<img src="img/puffin-2.jpg" height="400">
					</div>
				</section>

				<section>
					<h2>Resize limitations (2)</h2>

					<p>Resized as a 100x100 thumbnail:</p>

					<img src="img/puffin-2-crop.jpg" height="100" class="fragment">
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p class="fragment">Introduced in Preside 10.9</p>

					<img src="img/crop-hint.png" height="350" class="fragment">
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p>Introduced in Preside 10.9</p>

					<img src="img/crop-hint-selected.png" height="350">
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p>Simply tell your derivative to use crop hints:</p>

					<pre><code data-trim class="typescript">
					settings.assetManager.derivatives.croppedThumbnail = {
						  permissions = "inherit"
						, transformations = [
							{
								  method = "resize"
								, args   = {
									  width       = 100
									, height      = 100
									, useCropHint = true
								  }
							}
						]
					};
					</code></pre>
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p class="fragment">Now our thumbnail will look like this:</p>

					<img src="img/puffin-2-crop-hint-crop.jpg" height="100" class="fragment">
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p class="fragment">Crop hints are also useful for cropping portraits:</p>

					<img src="img/businessman.jpg" height="350" class="fragment">
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p>Crop hints are also useful for cropping portraits:</p>

					<img src="img/businessman-crop.jpg" height="200">
				</section>

				<section>
					<h2>Crop Hints</h2>

					<p>Crop hints are also useful for cropping portraits:</p>

					<img src="img/businessman-crop.jpg" height="200" style="border-radius:50%;">

					<pre><code data-trim class="css">
					img.avatar {
						border-radius : 50%;
					}
					</code></pre>
				</section>

				<section>
					<h2>Responsive Images</h2>

					<ul>
						<li class="fragment">Two different use cases
							<ul>
								<li class="fragment">Different resolutions of the same image</li>
								<li class="fragment">Art direction: variations on an image</li>
							</ul>
						</li>
						<li class="fragment">Two methods of implementation
							<ul>
								<li class="fragment"><code>&lt;img srcset="..."&gt;</code></li>
								<li class="fragment"><code>&lt;picture/&gt;</code></li>
							</ul>
						</li>
						<li class="fragment">Only load the preferred image version</li>
						<li class="fragment">Excellent support by modern browsers</li>
						<li class="fragment">Degrades gracefully</li>
					</li>
				</section>

				<section data-markdown="slides/srcset.md"></section>

				<section>
					<h2>srcset</h2>

					<img src="img/caniuse-srcset.png" width="750">
				</section>

				<section>
					<h2>picture</h2>

					<pre class="fragment"><code data-trim class="html">
					<picture>
						<source srcset="large.jpg"  media="(min-width: 901px)">
						<source srcset="medium.jpg" media="(min-width: 600px)">
						<source srcset="small.jpg">
						<img src="medium.jpg" alt="...">
					</picture>
					</code></pre>

					<ul>
						<li class="fragment">More complex, but more controllable</li>
						<li class="fragment">Best for art direction</li>
						<li class="fragment"><code>srcset</code> can include multiple resolutions</li>
						<li class="fragment">Falls back to <code>&lt;img&gt;</code> content if not supported</li>
					</ul>
				</section>

				<section>
					<h2>picture</h2>

					<img src="img/caniuse-picture.png" width="750">
				</section>

				<section>
					<h2>Some examples in Preside</h2>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				  dependencies : [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				  ]
				, center       : false
				, progress     : false
				, controls     : false
				, transition   : "none"
				, loop         : true
			});
		</script>
	</body>
</html>
